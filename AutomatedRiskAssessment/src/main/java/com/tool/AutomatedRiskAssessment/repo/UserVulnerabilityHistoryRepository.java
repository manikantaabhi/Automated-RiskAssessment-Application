package com.tool.AutomatedRiskAssessment.repo;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;

import com.tool.AutomatedRiskAssessment.model.User;
import com.tool.AutomatedRiskAssessment.model.UserVulnerabilityHistory;
import com.tool.AutomatedRiskAssessment.model.Vulnerability;

import java.util.List;

public interface UserVulnerabilityHistoryRepository extends JpaRepository<UserVulnerabilityHistory, Long> {
    List<UserVulnerabilityHistory> findByUser_Username(String username);
    
    @Query("SELECT COUNT(uh) > 0 FROM UserVulnerabilityHistory uh WHERE uh.user = :user AND uh.vulnerability.cveId = :cveId")
    boolean existsByUserAndCveId(@Param("user") User user, @Param("cveId") String cveId);

	List<UserVulnerabilityHistory> findByUserAndVulnerabilityCveIdIn(User user, List<String> cveIds);

}


/* this repo is responsible for storing history of the user saved cve items*/