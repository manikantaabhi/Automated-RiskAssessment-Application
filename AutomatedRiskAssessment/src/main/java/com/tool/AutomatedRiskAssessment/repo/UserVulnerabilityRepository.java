package com.tool.AutomatedRiskAssessment.repo;

import com.tool.AutomatedRiskAssessment.model.UserVulnerability;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import java.util.List;

public interface UserVulnerabilityRepository extends JpaRepository<UserVulnerability, Long> {

    @Query("SELECT uv.cveId FROM UserVulnerability uv WHERE uv.username = :username")
    List<String> findCveIdsByUsername(String username);

    boolean existsByUsernameAndCveId(String username, String cveId);
}
