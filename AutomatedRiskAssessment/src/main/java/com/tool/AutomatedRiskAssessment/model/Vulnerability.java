package com.tool.AutomatedRiskAssessment.model;

import jakarta.persistence.*;
import lombok.*;

import java.util.ArrayList;
import java.util.List;

import com.fasterxml.jackson.annotation.JsonManagedReference;

@Entity
@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
@ToString
public class Vulnerability {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(unique = true, nullable = false)
    private String cveId;

    private String sourceIdentifier;
    private String published;
    private String lastModified;
    private String vulnStatus;

    @Column(columnDefinition = "TEXT")
    private String description;

    @OneToMany(mappedBy = "vulnerability", cascade = CascadeType.ALL, orphanRemoval = true, fetch = FetchType.LAZY)
    @JsonManagedReference
    private List<Metric> metrics = new ArrayList<Metric>();

    @OneToMany(mappedBy = "vulnerability", cascade = CascadeType.ALL, orphanRemoval = true)
    @JsonManagedReference
    private List<VulnerabilityReference> references;

    
    

	public Long getId() {
		return id;
	}

	public void setId(Long id) {
		this.id = id;
	}

	public String getCveId() {
		return cveId;
	}

	public void setCveId(String cveId) {
		this.cveId = cveId;
	}

	public String getSourceIdentifier() {
		return sourceIdentifier;
	}

	public void setSourceIdentifier(String sourceIdentifier) {
		this.sourceIdentifier = sourceIdentifier;
	}

	public String getPublished() {
		return published;
	}

	public void setPublished(String published) {
		this.published = published;
	}

	public String getLastModified() {
		return lastModified;
	}

	public void setLastModified(String lastModified) {
		this.lastModified = lastModified;
	}

	public String getVulnStatus() {
		return vulnStatus;
	}

	public void setVulnStatus(String vulnStatus) {
		this.vulnStatus = vulnStatus;
	}

	public String getDescription() {
		return description;
	}

	public void setDescription(String description) {
		this.description = description;
	}

	public List<Metric> getMetrics() {
		return metrics;
	}

	public void setMetrics(List<Metric> metrics) {
		this.metrics = metrics;
	}

	public List<VulnerabilityReference> getReferences() {
		return references;
	}

	public void setReferences(List<VulnerabilityReference> references) {
		this.references = references;
	}
	public Vulnerability() {
		
	}

	public Vulnerability(Long id, String cveId, String sourceIdentifier, String published, String lastModified,
			String vulnStatus, String description, List<Metric> metrics, List<VulnerabilityReference> references) {
		super();
		this.id = id;
		this.cveId = cveId;
		this.sourceIdentifier = sourceIdentifier;
		this.published = published;
		this.lastModified = lastModified;
		this.vulnStatus = vulnStatus;
		this.description = description;
		this.metrics = metrics;
		this.references = references;
	}

	@Override
	public String toString() {
			String str="";
			try {
			str= "Vulnerability [id=" + id + ", cveId=" + cveId + ", sourceIdentifier=" + sourceIdentifier
					+ ", published=" + published + ", lastModified=" + lastModified + ", vulnStatus=" + vulnStatus
					+ ", description=" + description + ", metrics=" + metrics + ", references=" + references + "]";
			}
			catch(Exception e)
			{
				System.out.println(e.getMessage());
			}
			return str;
		}
    
    
}
