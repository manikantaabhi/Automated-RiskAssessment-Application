package com.tool.AutomatedRiskAssessment.model;

import jakarta.persistence.*;
import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;

import com.fasterxml.jackson.annotation.JsonManagedReference;

@Entity
@Table(name = "vulnerability_details")
public class VulnerabilityDetails {

    
    //@GeneratedValue(strategy = GenerationType.IDENTITY)
    //private Long id;
    
    private String company;
    private String product;
    private String version;
    
    @Id
    @Column(name = "cve_id")
    private String cveId;
    
    @Lob // Allows longer text
    private String description;

    private double baseScore;
    private String severity;
    private LocalDate lastModified;
    
    private String type;

    // New Relationship for References
   // @OneToMany(mappedBy = "vulnerabilityDetails", cascade = CascadeType.ALL, orphanRemoval = true, fetch = FetchType.EAGER)
    //@JsonManagedReference // Manages circular reference issues in JSON
    //private List<VulnerabilityDetailsReferences> references = new ArrayList<>();

    @Column(name = "vulnerability_references", length = 2000) // Optional: Increase length if needed
    private String references;

    
    // Getters and Setters
    public String getType() {
        return type;
    }

    public void setType(String type) {
        this.type = type;
    }
    
    
    public String getCompany() {
        return company;
    }

    public void setCompany(String company) {
        this.company = company;
    }

    public String getProduct() {
        return product;
    }

    public void setProduct(String product) {
        this.product = product;
    }

    public String getVersion() {
        return version;
    }

    public void setVersion(String version) {
        this.version = version;
    }

    public String getCveId() {
        return cveId;
    }

    public void setCveId(String cveId) {
        this.cveId = cveId;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public double getBaseScore() {
        return baseScore;
    }

    public void setBaseScore(double baseScore) {
        this.baseScore = baseScore;
    }

    public String getSeverity() {
        return severity;
    }

    public void setSeverity(String severity) {
        this.severity = severity;
    }

    public LocalDate getLastModified() {
        return lastModified;
    }

    public void setLastModified(LocalDate lastModified) {
        this.lastModified = lastModified;
    }

    /*public List<VulnerabilityDetailsReferences> getReferences() {
        return references;
    }

    public void setReferences(List<VulnerabilityDetailsReferences> references) {
        this.references = references;
    }*/
    
    public String getReferences() {
        return references;
    }

    public void setReferences(String references) {
        this.references = references;
    }

}
