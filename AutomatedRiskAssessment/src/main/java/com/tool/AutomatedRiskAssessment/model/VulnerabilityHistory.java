package com.tool.AutomatedRiskAssessment.model;

import jakarta.persistence.*;
import java.util.*;

import com.fasterxml.jackson.annotation.JsonManagedReference;
@Entity
@Table(name = "vulnerability_history")
public class VulnerabilityHistory {
    
	@Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private String company;
    private String version;
    @Column(unique = true)
    private String cveId;
    private String severity;
    @Column(length = 65535)  // Use TEXT type in DB
    private String description;

    @ManyToOne
    @JoinColumn(name = "username", referencedColumnName = "username", nullable = false)
    private User user;

    @OneToMany(mappedBy = "vulnerabilityHistory", cascade = CascadeType.ALL, orphanRemoval = true)
    @JsonManagedReference  // Manage the relationship here
    private List<VulnerabilityHistoryReference> references = new ArrayList<>();
	public Long getId() {
		return id;
	}

	public void setId(Long id) {
		this.id = id;
	}
	
	public String getCompany() {
		return company;
	}

	public void setCompany(String company) {
		this.company = company;
	}

	public String getVersion() {
		return version;
	}

	public void setVersion(String version) {
		this.version = version;
	}

	public String getCveId() {
		return cveId;
	}

	public void setCveId(String cveId) {
		this.cveId = cveId;
	}

	public String getSeverity() {
		return severity;
	}

	public void setSeverity(String severity) {
		this.severity = severity;
	}

	public String getDescription() {
		return description;
	}

	public void setDescription(String description) {
		this.description = description;
	}

	public User getUser() {
		return user;
	}

	public void setUser(User user) {
		this.user = user;
	}

	public List<VulnerabilityHistoryReference> getReferences() {
		return references;
	}

	public void setReferences(List<VulnerabilityHistoryReference> references) {
		this.references = references;
	}

	@Override
	public String toString() {
		return "VulnerabilityHistory [id=" + id + ", company=" + company + ", version=" + version + ", cveId="
				+ cveId + ", severity=" + severity + ", description=" + description + ", user=" + user + ", references="
				+ references + "]";
	}
    
    // Getters, Setters
	
    
}
